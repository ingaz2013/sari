# ุฏููู ุชุดุบูู ูุธุงู ุงูุฏูุน ูู ุงูุฅูุชุงุฌ

## ๐ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. ููุงุชูุญ Tap Payments (Production Keys)
- โ `TAP_SECRET_KEY`: ููุชุงุญ ุณุฑู ููุฅูุชุงุฌ (Live Secret Key)
- โ `VITE_TAP_PUBLIC_KEY`: ููุชุงุญ ุนุงู ููุฅูุชุงุฌ (Live Public Key)

**ููุงุญุธุฉ:** ุงูููุงุชูุญ ููุฌูุฏุฉ ุจุงููุนู ูู ุงููุธุงู ุนุจุฑ Manus Secrets.

---

## ๐ ุชุณุฌูู Webhook ูู Tap

### ุงูุฎุทูุงุช:
1. ุณุฌู ุงูุฏุฎูู ุฅูู [ููุญุฉ ุชุญูู Tap](https://dashboard.tap.company)
2. ุงุฐูุจ ุฅูู **Settings** โ **Webhooks**
3. ุฃุถู Webhook URL ุงูุฌุฏูุฏ:
   ```
   https://your-domain.manus.space/api/webhooks/tap
   ```
4. ุงุฎุชุฑ ุงูุฃุญุฏุงุซ ุงูุชุงููุฉ:
   - โ `charge.captured` (ุฏูุน ูุงุฌุญ)
   - โ `charge.failed` (ุฏูุน ูุงุดู)
   - โ `charge.refunded` (ุงุณุชุฑุฌุงุน)

5. ุงุญูุธ ุงูุชุบููุฑุงุช

---

## ๐งช ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. ุงุฎุชุจุงุฑ ุฅูุดุงุก Charge
```bash
# ูู ุตูุญุฉ ุงูุงุดุชุฑุงูุงุชุ ุงุฎุชุฑ ุจุงูุฉ ูุงุถุบุท "ุงุฎุชูุงุฑ ุงูุจุงูุฉ"
# ูุฌุจ ุฃู ูุชู ุชูุฌููู ุฅูู ุตูุญุฉ Checkout
```

### 2. ุงุฎุชุจุงุฑ ุงูุฏูุน
```bash
# ูู ุตูุญุฉ Checkout:
# 1. ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน (Tap Payment)
# 2. ุงุถุบุท "ุฅุชูุงู ุงูุฏูุน"
# 3. ูุฌุจ ุฃู ูุชู ุชูุฌููู ุฅูู ุตูุญุฉ Tap ููุฏูุน
# 4. ุฃููู ุงูุฏูุน ุจุงุณุชุฎุฏุงู ุจุทุงูุฉ ุญููููุฉ
```

### 3. ุงุฎุชุจุงุฑ Webhook
```bash
# ุจุนุฏ ุงูุฏูุน ุงููุงุฌุญุ ูุฌุจ ุฃู ูุญุฏุซ ุงูุชุงูู ุชููุงุฆูุงู:
# โ ุชุญุฏูุซ ุญุงูุฉ ุงูุฏูุน ุฅูู "completed"
# โ ุชุญุฏูุซ ุญุงูุฉ ุงูุงุดุชุฑุงู ุฅูู "active"
# โ ุฅูุดุงุก ูุงุชูุฑุฉ PDF
# โ ุฅุฑุณุงู ุงููุงุชูุฑุฉ ููุชุงุฌุฑ ุนุจุฑ ุงูุจุฑูุฏ
# โ ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุฏูุฑ
```

---

## ๐ ูุฑุงูุจุฉ ุงููุธุงู

### Logs ุงููููุฉ
```bash
# ูู server logsุ ุงุจุญุซ ุนู:
[Tap Payment] Creating charge: {...}
[Tap Payment] Charge created successfully: {...}
[Tap Webhook] Received webhook: {...}
[Tap Webhook] Payment completed successfully: {...}
```

### ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ
1. **"Tap Secret Key is not configured"**
   - ุชุฃูุฏ ูู ูุฌูุฏ `TAP_SECRET_KEY` ูู Secrets

2. **"Payment not found"** ูู Webhook
   - ุชุฃูุฏ ูู ุฃู `reference.number` ูุญุชูู ุนูู `paymentId` ุงูุตุญูุญ

3. **"Failed to create charge"**
   - ุชุญูู ูู ุตุญุฉ ุงูููุงุชูุญ (Live vs Test)
   - ุชุญูู ูู ุฑุตูุฏ ุงูุญุณุงุจ ูู Tap

---

## ๐ ุงูุฃูุงู

### ุงูุชุญูู ูู Webhook Signature
ุงููุธุงู ูุชุญูู ุชููุงุฆูุงู ูู ุตุญุฉ Webhook ุจุงุณุชุฎุฏุงู HMAC SHA256:
```typescript
const hash = crypto
  .createHmac('sha256', secretKey)
  .update(payload)
  .digest('hex');
```

### ุญูุงูุฉ ุงูููุงุชูุญ
- โ ูุง ุชุถุน ุงูููุงุชูุญ ูู ุงูููุฏ ูุจุงุดุฑุฉ
- โ ุงุณุชุฎุฏู Manus Secrets ููุท
- โ ูุง ุชุดุงุฑู ุงูููุงุชูุญ ูุน ุฃู ุดุฎุต

---

## ๐ง ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู

ูุฅุฑุณุงู ุงูููุงุชูุฑ ุชููุงุฆูุงูุ ุชุฃูุฏ ูู ุฅุนุฏุงุฏ SMTP:
```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM=noreply@sari.sa
```

---

## ๐ ุงูุงูุทูุงู

### ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ:
- [x] ููุงุชูุญ Tap Production ููุฌูุฏุฉ ูู Secrets
- [ ] Webhook URL ูุณุฌู ูู ููุญุฉ ุชุญูู Tap
- [ ] ุงุฎุชุจุงุฑ ุฏูุน ุญูููู ูุงุฌุญ
- [ ] Webhook ูุนูู ุจุดูู ุตุญูุญ
- [ ] ุงูููุงุชูุฑ ุชูุฑุณู ุชููุงุฆูุงู
- [ ] Logs ุชุธูุฑ ุจุดูู ุตุญูุญ

---

## ๐ ุงูุฏุนู ุงูููู

### Tap Support
- ุงูุจุฑูุฏ: support@tap.company
- ุงููุงุชู: +965 2220 0442
- ุงููุซุงุฆู: https://developers.tap.company

### ูุดุงูู ุงููุธุงู
- ุชุญูู ูู Logs ูู server console
- ุชุญูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุฌุฏูู `payments`)
- ุชุญูู ูู Webhook logs ูู ููุญุฉ ุชุญูู Tap

---

**ุขุฎุฑ ุชุญุฏูุซ:** ุฏูุณูุจุฑ 2024
